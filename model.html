<!DOCTYPE html>
	<head>
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<title>DENT A.R.</title>
		<!-- include three.js library -->
		<script src='js/three.js'></script>
		<script src='js/OBJLoader.js'></script>
		<script src='js/MTLLoader.js'></script>
		<!-- include jsartookit -->
		<script src="jsartoolkit5/artoolkit.min.js"></script>
		<script src="jsartoolkit5/artoolkit.api.js"></script>
		<!-- include threex.artoolkit -->
		<script src="threex/threex-artoolkitsource.js"></script>
		<script src="threex/threex-artoolkitcontext.js"></script>
		<script src="threex/threex-arbasecontrols.js"></script>
		<script src="threex/threex-armarkercontrols.js"></script>
		<link rel="stylesheet" href="css/index.css" />
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
	</head>

	<body style='margin : 0px; overflow: hidden; font-family: Monospace;'>
		<!-- Checklist Overlay -->
		<div
		id="checklist"
		class="position-fixed top-0 start-0 p-3"
		style="opacity: 0.8"
			>
		<ul class="list-group" id="patternList">
			<!-- Checklist items will be added here dynamically -->
		</ul>
	</div>

	<!-- Popup for 3D Model -->
	<div class="modal" tabindex="-1" role="dialog" id="modelPopup">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Congratulations!</h5>
					<button
						type="button"
						class="close"
						data-dismiss="modal"
						aria-label="Close"
					>
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<p>All patterns found! Here is your 3D model:</p>
					<!-- 3D Model will be displayed here -->
					<!-- <div id="modelContainer"></div> -->
					<!-- embed a gif -->
					<img
						src="https://media1.tenor.com/m/eG9Ro44EyMcAAAAd/our-solar-system-planetary-system.gif"
						alt="3D Model"
						width="100%"
					/>
					<!-- add a button to reload thats (play again?) -->
					<button
						type="button"
						class="btn btn-primary"
						onclick="window.location.reload();"
					>
						Play Again
					</button>
					<!-- add button to navigate back to home page -->
					<button
						type="button"
						class="btn btn-secondary"
						onclick="window.location.href = 'index.html';"
					>
						Back to Home
					</button>
				</div>
			</div>
		</div>
	</div>

		<div class="overlay-layout">
			<div class="row">
				<div class="col-12">
					<button class="btn btn-primary increase-font">Increase Font Size</button>
					<button class="btn btn-secondary decrease-font">Decrease Font Size</button>
				</div>
			</div>
			<div class="row">
				<div class="col-12">
					<div class="overlay-text">
						<h1 class="overlay-title">Laptop</h1>
						<p class="overlay-description">Imagine a magical box that can take you on exciting adventures to distant lands, help you build your own games, or even chat with astronauts in space! That's what a laptop is - a doorway to a world where you can learn and play at the same time. You can use it to draw colorful pictures, solve fun puzzles that teach you math, and watch fascinating videos about the stars and planets!</p>
					</div>
				</div>
			</div>
		</div>

<script>
	var scene, camera, renderer, clock, deltaTime, totalTime;
	var arToolkitSource, arToolkitContext;
	var markerRoots = [];
	var meshs = [];
	var patternArray = [
		"letterA",
		"letterB",
		"letterC",
		"letterD",
		"letterF",
	];
	var foundPatterns = new Array(patternArray.length).fill(false);

	document.addEventListener('DOMContentLoaded', function() {
		initialize();
		animate();
	});

	window.onload = function() {
		buttonFunctionality();
	}

	function initialize()
	{
		scene = new THREE.Scene();

		let ambientLight = new THREE.AmbientLight( 0xcccccc, 1.0 );
		scene.add( ambientLight );

		camera = new THREE.Camera();
		scene.add(camera);

		renderer = new THREE.WebGLRenderer({
			antialias : true,
			alpha: true
		});
		renderer.setClearColor(new THREE.Color('lightgrey'), 0)
		renderer.setSize( 640, 480 );
		renderer.domElement.style.position = 'absolute'
		renderer.domElement.style.top = '0px'
		renderer.domElement.style.left = '0px'
		document.body.appendChild( renderer.domElement );

		clock = new THREE.Clock();
		deltaTime = 0;
		totalTime = 0;

		arToolkitSource = new THREEx.ArToolkitSource({
			sourceType : 'webcam',
		});

		function onResize()
		{
			arToolkitSource.onResize()
			arToolkitSource.copySizeTo(renderer.domElement)
			if ( arToolkitContext.arController !== null )
			{
				arToolkitSource.copySizeTo(arToolkitContext.arController.canvas)
			}
		}

		arToolkitSource.init(function onReady(){
			onResize()
		});

		// handle resize event
		window.addEventListener('resize', function(){
			onResize()
		});

		arToolkitContext = new THREEx.ArToolkitContext({
			cameraParametersUrl: 'data/camera_para.dat',
			detectionMode: 'mono'
		});

		arToolkitContext.init( function onCompleted(){
			camera.projectionMatrix.copy( arToolkitContext.getProjectionMatrix() );
		});

		let patternArray = [
			"letterA",
			"letterB",
			"letterC",
			"letterD",
			"letterF",
		];

		let foundPatterns = new Array(patternArray.length).fill(false);

		for(let i = 0; i < patternArray.length; ++i) {

		}

		let markerRoot = new THREE.Group();
		scene.add(markerRoot);
		let markerControls1 = new THREEx.ArMarkerControls(arToolkitContext, markerRoot1, {
			type: 'pattern', patternUrl: "data/hiro.patt",
		})

		let geometry = new THREE.PlaneBufferGeometry(1,1, 4,4);
		let loader = new THREE.TextureLoader();
		let texture = loader.load( 'images/earth.jpg', render );
		let material1 = new THREE.MeshBasicMaterial( { color: 0x0000ff, opacity: 0.5 } );
		mesh = new THREE.Mesh( geometry1, material1 );
		mesh.rotation.x = -Math.PI/2;
		markerRoots.add( mesh );

		function onProgress(xhr) { console.log( (xhr.loaded / xhr.total * 100) + '% loaded' ); }
		function onError(xhr) { console.log( 'An error happened' ); }

		new THREE.MTLLoader()
			.setPath( 'models/' )
			.load( 'laptop_complete.mtl', function ( materials ) {
				materials.preload();
				new THREE.OBJLoader()
					.setMaterials( materials )
					.setPath( 'models/' )
					.load( 'laptop_complete.obj', function ( group ) {
						mesh0 = group.children[0];
						mesh0.material.side = THREE.DoubleSide;
						mesh0.position.y = 0.25;
						mesh0.scale.set(1,1,1);
						markerRoot1.add(mesh0);
					}, onProgress, onError );
			});
	}


	function update() {
		// update artoolkit on every frame
		if ( arToolkitSource.ready !== false )
			arToolkitContext.update( arToolkitSource.domElement );
	}

	function render()
	{
		renderer.render( scene, camera );
	}


	function animate()
	{
		requestAnimationFrame(animate);
		deltaTime = clock.getDelta();
		totalTime += deltaTime;
		update();
		render();
	}

	function increaseTextSize() {
		let overlayText = document.querySelector('.overlay-text');
		let currentFontSize = parseFloat(window.getComputedStyle(overlayText, null).getPropertyValue('font-size'));
		overlayText.style.fontSize = (currentFontSize + 1) + 'px';
		console.log('Text size increased')
	}

	function decreaseTextSize() {
		let overlayText = document.querySelector('.overlay-text');
		let currentFontSize = parseFloat(window.getComputedStyle(overlayText, null).getPropertyValue('font-size'));
		if (currentFontSize > 1) {
			overlayText.style.fontSize = (currentFontSize - 1) + 'px';
		}
		console.log('Text size decreased')
	}

	function buttonFunctionality() {
		let increaseButton = document.querySelector('.increase-font');
		let decreaseButton = document.querySelector('.decrease-font');

		increaseButton.addEventListener('click', increaseTextSize);
		decreaseButton.addEventListener('click', decreaseTextSize);
		console.log('attaching event listeners to button')
	}

	</script>

	</body>
</html>
